{% extends 'base.html' %}
{% load static %}

{% block title %}Slayd 11 - Statistika va Ma'lumotlar{% endblock %}

{% block content %}
<div class="slide-container">
    <div class="container">
        <div class="slide-content">
            <div class="text-center mb-5">
                <span class="badge bg-primary mb-3 px-4 py-2">Slayd 11 / 12</span>
                <h1 class="display-4 mb-3 fw-bold gradient-text">Islohatlari Natijalari: Statistika va Ma'lumotlar</h1>
                <p class="lead text-muted">2009-2024 yillarida EU qoidalari bilan kiritilgan islohatlari raqamlar orqali ko'rishimiz</p>
            </div>

            <hr class="my-4">

            <!-- Intro Alert -->
            <div class="row mb-5">
                <div class="col-lg-12">
                    <div class="alert alert-info border-0 shadow-sm">
                        <h5 class="alert-heading mb-2">
                            <i class="fas fa-chart-bar me-2"></i>Nima uchun bu ma'lumotlar muhim?
                        </h5>
                        <p class="mb-0">
                            2008-2009 yillarida global moliyaviy inqirozi bo'lib, ko'p investorlar moliyaviy qiyrachiliklari yo'qot bo'ldi. 
                            Sababi: rating agentliklari xato reytinglar bergan edi. Shuning uchun EU yangi qoidalarni qabul qildi. 
                            Quyidagi diogrammalar bu qoidalarning naqadar samarali ekanligini ko'rsatadi.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Charts Row 1 -->
            <div class="row mb-5">
                <div class="col-lg-6 mb-4">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body">
                            <h5 class="card-title mb-2">
                                <i class="fas fa-chart-line text-primary me-2"></i>
                                1️⃣ Bahovchilar Soni Qanday O'zgarganlar?
                            </h5>
                            <p class="text-muted small mb-3">
                                <strong>2009 yilida:</strong> Dunyoda faqat 3 ta asosiy rating agentligi bor edi - S&P, Moody's va Fitch. 
                                Bu demak, raqobat yo'q, investorlar har birini ishonib ketishi kerak edi. 
                                <strong>2024 yilida:</strong> Yangi bahovchilar ruxsat berildi va endi 6 ta katta bahovchi mavjud. 
                                Bu raqobat ortirdi, xizmat sifati yaxshilandi.
                            </p>
                            <div style="height: 250px;">
                                <canvas id="bahovchilarChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6 mb-4">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body">
                            <h5 class="card-title mb-2">
                                <i class="fas fa-percent text-success me-2"></i>
                                2️⃣ "Katta Uchlikning" Bozor Ulushi Qanday Pasaydi?
                            </h5>
                            <p class="text-muted small mb-3">
                                <strong>2009 yilida:</strong> S&P, Moody's, Fitch uchta kompaniya dunyo bozorining 95% ini nazorat qilardi. 
                                Bu juda xavfli - agar bu uchta bror xato qilsa, butun dunyo zarrar ko'radi. 
                                <strong>2024 yilida:</strong> Yangi bahovchilar ruxsat berilgani uchun ularning ulushi 78% ga pasaydi. 
                                Demak, bozor ko'proq diversifikatsiya bo'ldi, xavf azaldi.
                            </p>
                            <div style="height: 250px;">
                                <canvas id="jaripyaChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts Row 2 -->
            <div class="row mb-5">
                <div class="col-lg-6 mb-4">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body">
                            <h5 class="card-title mb-2">
                                <i class="fas fa-euro-sign text-warning me-2"></i>
                                3️⃣ Jarimalari Nima Uchun Ko'paydi?
                            </h5>
                            <p class="text-muted small mb-3">
                                <strong>2010 yilida:</strong> Qoidalarga amal qilmagan agentlikka faqat €5 million jarima berildi. 
                                Juda kichik - bu agentliklarga qo'rquv emas edi. 
                                <strong>2024 yilida:</strong> Endi jarima €55 million ga oshdi (11 marta ko'paydi). 
                                Bu demak: qoidalarga amal qilish to'g'ri emas, keskin jaza mavjud.
                            </p>
                            <div style="height: 250px;">
                                <canvas id="jarimalerChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6 mb-4">
                    <div class="card border-0 shadow-sm h-100">
                        <div class="card-body">
                            <h5 class="card-title mb-2">
                                <i class="fas fa-chart-pie text-info me-2"></i>
                                4️⃣ Rating Xatolar Nima Uchun Azaldi?
                            </h5>
                            <p class="text-muted small mb-3">
                                <strong>2012 yilida:</strong> 75% jarayonlarda rating xatolar bor edi. 
                                Bu demak: to'rt jarayondan uchida notog'ri reyting berilgan, investorlar aldanadi. 
                                <strong>2024 yilida:</strong> Xatolar 20% ga tushdi (3.75 marta azaldi). 
                                Nima sababi? Yangi qoidalar, qat'iy nazorat, sertifikatsiya talabi - hamasi xatolarni kamayti.
                            </p>
                            <div style="height: 250px;">
                                <canvas id="xatolerChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Data Summary Table -->
            <div class="row">
                <div class="col-lg-12">
                    <div class="card border-0 shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title mb-3">
                                <i class="fas fa-table text-primary me-2"></i>
                                Qisqacha Xulosa: Asosiy O'zgarishlar (Oldin va Keyin)
                            </h5>
                            <p class="text-muted small mb-3">
                                Quyidagi jadval islohatlari oldin (2009-2012) va keyin (2024) holatlarini taqqoslab ko'rsatadi. 
                                Qizil rangda kisi - muammolar bor edi. Yashil rangda - muammolar hal qilindi.
                            </p>
                            <div class="table-responsive">
                                <table class="table table-hover align-middle">
                                    <thead class="table-light">
                                        <tr>
                                            <th style="width: 25%;">Ko'rsatkich</th>
                                            <th style="width: 20%;">Oldin (2009-2012)</th>
                                            <th style="width: 20%;">Keyin (2024)</th>
                                            <th style="width: 35%;">Nima O'zgarganlar?</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><strong>Bahovchilar Soni</strong></td>
                                            <td><span class="badge bg-danger">3 ta (monopoliya)</span></td>
                                            <td><span class="badge bg-success">6 ta (raqobat)</span></td>
                                            <td>+100% ↑ - Monopoliya buzildi, raqobat ortdi</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Bozor Ulushi (Big 3)</strong></td>
                                            <td><span class="badge bg-danger">95% (xavf)</span></td>
                                            <td><span class="badge bg-success">78% (xavf azaldi)</span></td>
                                            <td>-17% ↓ - Bozor diversifikatsiyasi</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Jarimalari</strong></td>
                                            <td><span class="badge bg-danger">€5M (juda kichik)</span></td>
                                            <td><span class="badge bg-success">€55M (juda katta)</span></td>
                                            <td>+11x ↑ - Qoidalarga amal majbur</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Rating Xatolar</strong></td>
                                            <td><span class="badge bg-danger">75% (investorlar aldanadi)</span></td>
                                            <td><span class="badge bg-success">20% (ishonch ortdi)</span></td>
                                            <td>-3.75x ↓ - Reyting sifati yaxshilandi</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Navigation -->
<div class="slide-navigation">
    <div class="d-flex align-items-center gap-3">
        <a href="{% url 'resume' %}" class="btn btn-outline-secondary">
            <i class="fas fa-home me-2"></i> Bosh sahifa
        </a>
        <a href="/baholash/10/" class="btn btn-outline-primary">
            <i class="fas fa-arrow-left me-2"></i> Oldingi
        </a>
        <span class="badge bg-dark px-3 py-2">11 / 12</span>
        <a href="/baholash/12/" class="btn btn-primary">
            Keyingi <i class="fas fa-arrow-right ms-2"></i>
        </a>
    </div>
</div>

<style>
    .slide-content {
        max-width: 1200px;
        margin: 0 auto;
    }
    
    .gradient-text {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    
    canvas {
        max-height: 100%;
        max-width: 100%;
    }
</style>

<!-- Chart.js Library -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const chartConfig = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                }
            }
        };

        // 1. Bahovchilar Soni Chart
        const bahovchilarCtx = document.getElementById('bahovchilarChart');
        if (bahovchilarCtx) {
            new Chart(bahovchilarCtx, {
                type: 'bar',
                data: {
                    labels: ['2009', '2024'],
                    datasets: [{
                        label: 'Bahovchilar Soni',
                        data: [3, 6],
                        backgroundColor: [
                            'rgba(255, 193, 7, 0.85)',
                            'rgba(40, 167, 69, 0.85)'
                        ],
                        borderColor: [
                            'rgba(255, 193, 7, 1)',
                            'rgba(40, 167, 69, 1)'
                        ],
                        borderWidth: 2,
                        borderRadius: 6
                    }]
                },
                options: {
                    ...chartConfig,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 8
                        }
                    }
                }
            });
        }

        // 2. Bozor Ulushi Chart
        const jaripyaCtx = document.getElementById('jaripyaChart');
        if (jaripyaCtx) {
            new Chart(jaripyaCtx, {
                type: 'bar',
                data: {
                    labels: ['2009', '2024'],
                    datasets: [{
                        label: 'Bozor Ulushi (%)',
                        data: [95, 78],
                        backgroundColor: [
                            'rgba(255, 152, 0, 0.85)',
                            'rgba(76, 175, 80, 0.85)'
                        ],
                        borderColor: [
                            'rgba(255, 152, 0, 1)',
                            'rgba(76, 175, 80, 1)'
                        ],
                        borderWidth: 2,
                        borderRadius: 6
                    }]
                },
                options: {
                    ...chartConfig,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(v) {
                                    return v + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        // 3. Jarimalari Chart
        const jarimalerCtx = document.getElementById('jarimalerChart');
        if (jarimalerCtx) {
            new Chart(jarimalerCtx, {
                type: 'bar',
                data: {
                    labels: ['2010', '2024'],
                    datasets: [{
                        label: 'Jarimalari (Million €)',
                        data: [5, 55],
                        backgroundColor: [
                            'rgba(220, 53, 69, 0.85)',
                            'rgba(180, 30, 45, 0.85)'
                        ],
                        borderColor: [
                            'rgba(220, 53, 69, 1)',
                            'rgba(180, 30, 45, 1)'
                        ],
                        borderWidth: 2,
                        borderRadius: 6
                    }]
                },
                options: {
                    ...chartConfig,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 65,
                            ticks: {
                                callback: function(v) {
                                    return '€' + v + 'M';
                                }
                            }
                        }
                    }
                }
            });
        }

        // 4. Xatolar Chart
        const xatolerCtx = document.getElementById('xatolerChart');
        if (xatolerCtx) {
            new Chart(xatolerCtx, {
                type: 'bar',
                data: {
                    labels: ['2012', '2024'],
                    datasets: [{
                        label: 'Xatolar (%)',
                        data: [75, 20],
                        backgroundColor: [
                            'rgba(220, 53, 69, 0.85)',
                            'rgba(40, 167, 69, 0.85)'
                        ],
                        borderColor: [
                            'rgba(220, 53, 69, 1)',
                            'rgba(40, 167, 69, 1)'
                        ],
                        borderWidth: 2,
                        borderRadius: 6
                    }]
                },
                options: {
                    ...chartConfig,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(v) {
                                    return v + '%';
                                }
                            }
                        }
                    }
                }
            });
        }
    });
</script>

{% endblock %}
